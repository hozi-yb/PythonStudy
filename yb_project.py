import requests
import pandas as pd

"""  종관기상자료(ASOS)  일자료 받아오기.
"""

url = 'http://apis.data.go.kr/1360000/AsosDalyInfoService/getWthrDataList'
params = {'serviceKey': 'j1BP7pVQ3vWfMhTNzePDluGdwtVIcmq08X8c7T5Ean/bPWph1EXT0T2R/qCF2E9/18IrWnV9AkzvcXon0ceXAw==',
          'pageNo': '1',  # 페이지 수
          'numOfRows': '10',  # 한 페이지당 표출 데이터 수
          'dataType': 'JSON',
          'dataCd': 'ASOS',
          'dateCd': 'DAY',
          'startDt': '20200101',  # 시작날짜
          'endDt': '20201231',  # 마지막날짜
          'stnIds': '108'  # 기상관측 지점 지역코드
          }

# 위도경도
{
    {'속초': [38.25085, 128.56473]},
    {'북춘천': [37.94738, 127.75443]},
    {'철원': [38.14787, 127.3042]},
    {'동두천': [37.90188, 127.0607]},
    {'파주': [37.88589, 126.76648]},
    {'대관령': [37.67713, 128.71834]},
    {'춘천': [37.90262, 127.7357]},
    {'백령도': [37.97396, 124.71237]},
    {'북강릉': [37.80456, 128.85535]},
    {'강릉': [37.75147, 128.89099]},
    {'동해': [37.50709, 129.12433]},
    {'서울': [37.57142, 126.9658]},
    {'인천': [37.47772, 126.6249]},
    {'원주': [37.33749, 127.94659]},
    {'울릉도': [37.48129, 130.89864]},
    {'수원': [37.25746, 126.983]},
    {'충주': [36.97045, 127.9525]},
    {'서산': [36.77658, 126.4939]},
    {'청주': [36.63924, 127.44066]},
    {'대전': [36.37199, 127.3721]},
    {'추풍령': [36.22025, 127.99458]},
    {'안동': [36.57293, 128.70734]},
    {'상주': [36.40837, 128.15741]},
    {'포항': [36.03201, 129.38002]},
    {'대구': [35.87797, 128.65295]},
    {'전주': [35.84092, 127.11718]},
    {'울산': [35.58237, 129.33469]},
    {'창원': [35.17019, 128.57281]},
    {'광주': [35.17294, 126.89156]},
    {'부산': [35.10468, 129.03203]},
    {'통영': [34.84541, 128.43561]},
    {'목포': [34.81732, 126.38151]},
    {'여수': [34.73929, 127.74063]},
    {'흑산도': [34.68719, 125.45105]},
    {'완도': [34.3959, 126.70182]},
    {'고창': [35.34824, 126.599]},
    {'홍성': [36.65759, 126.68772]},
    {'서청주': [36.63994, 127.38458]},
    {'제주': [33.51411, 126.52969]},
    {'고산': [33.29382, 126.16283]},
    {'서귀포': [33.24616, 126.5653]},
    {'진주': [35.16378, 128.04004]},
    {'태백': [37.17038, 128.98929]},
    {'보령': [36.32724, 126.55744]},
    {'세종': [36.48522, 127.24438]},
    {'정읍': [35.56337, 126.83904]},
    {'고창군': [35.42661, 126.697]},
    {'영광군': [35.28366, 126.47784]},
    {'김해시': [35.22981, 128.89075]},
    {'순창군': [35.37131, 127.1286]},
    {'북창원': [35.22655, 128.6726]},
    {'양산시': [35.30737, 129.0201]},
    {'보성군': [34.76335, 127.21226]},
    {'강진군': [34.64457, 126.78408]},
    {'해남': [34.55375, 126.56907]},
    {'고흥': [34.61826, 127.27572]},
    {'의령군': [35.32258, 128.28812]},
    {'함양군': [35.51138, 127.74538]},
    {'광양시': [34.9434, 127.6914]},
    {'청송군': [36.4351, 129.04005]},
    {'경주시': [35.8174, 129.2009]},
    {'북부산': [35.21778, 128.96024]}}

response = requests.get(url, params=params)

data_json = response.json()
data_item = data_json["response"]["body"]["items"]["item"]

data_df = pd.DataFrame(data_item)

Gsr_data_df = data_df[["stnNm", "tm", "sumGsr"]]  # 컬럼 - 지점명, 날짜, 합계일사량

print(Gsr_data_df.to_string(index=False))

# print(response)
